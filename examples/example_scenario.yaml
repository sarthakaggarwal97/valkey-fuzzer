# Example DSL Configuration for Cluster Bus Fuzzer
# This file demonstrates the DSL format for defining reproducible test scenarios

scenario_id: "example-failover-with-chaos"
seed: 2207541902  # Successful random scenario

# Cluster configuration
cluster:
  num_shards: 16
  replicas_per_shard: 2
  base_port: 7669
  base_data_dir: "/tmp/valkey-fuzzer"
  valkey_binary: "/usr/local/bin/valkey-server"
  enable_cleanup: true

# Operations to execute
operations:
  - type: "failover"
    target_node: "shard-7-primary"
    parameters:
      force: true
    timing:
      delay_before: 0.46
      timeout: 55.56
      delay_after: 2.37
  
  - type: "failover"
    target_node: "shard-10-primary"
    parameters:
      force: true
    timing:
      delay_before: 3.52
      timeout: 20.57
      delay_after: 2.75
      
  - type: "failover"
    target_node: "shard-2-primary"
    parameters:
      force: false
    timing:
      delay_before: 2.44
      timeout: 44.67
      delay_after: 1.71

# Chaos configuration
chaos:
  type: "process_kill"
  process_chaos_type: "sigkill"
  
  target_selection:
    strategy: "replica_only"  # Options: random, primary_only, replica_only, specific
    # specific_nodes:  # Only used when strategy is "specific"
  
  timing:
    delay_before_operation: 0.5
    delay_after_operation: 0.5
    chaos_duration: 9.87
  
  coordination:
    chaos_before_operation: false
    chaos_during_operation: false
    chaos_after_operation: true

# State validation configuration
state_validation:
  check_slot_coverage: true
  check_cluster_status: true
  check_replication: true
  check_topology: true
  check_view_consistency: true
  check_data_consistency: true
  stabilization_wait: 5.0
  validation_timeout: 60.0
  replication_config:
    max_acceptable_lag: 5.0
